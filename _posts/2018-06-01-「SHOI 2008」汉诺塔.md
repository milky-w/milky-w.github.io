---
title: 「SHOI 2008」汉诺塔
date: 2018-06-01 08:12:11
categories:
- 动态规划
tags:
- DP
mathjax: true
---

> 题目大意：给定移动优先级的汉诺塔游戏，求多少步走完。$AB$ 表示从 $A$ 移到 $B$。$1≤n≤30$ 表示盘子的个数，答案不会超过 $10^{18}$。

我好像只会暴力……

回顾经典汉诺塔的公式：$f[i] = 2 × f[i-1] + 1$，我记得当时初中老师讲，想象把上面 $i-1$ 个小圆盘捆在一起，先把这些小圆盘移到 $B$ 柱上，再把最下面的圆盘移到 $C$ 柱上，最后把 $B$ 柱上的小圆盘移到 $C$ 柱上。

规定了移动优先级之后本质还是一样的……可以发现若要把 $A$ 柱上的所有圆盘移到 $B$ 柱上只有两种方案：

1. $i-1$ 个圆盘 $A$ → $C$，最后一个圆盘 $A$ → $B$，$i-1$ 个圆盘 $C$ → $B$；
2. $i-1$ 个圆盘 $A$ → $B$，最后一个圆盘 $A$ → $C$，$i-1$ 个圆盘 $B$ → $A$，最后一个圆盘 $C$ → $B$，$i-1$ 个圆盘 $A$ → $B$。

用 $0,1,2$ 表示三根柱子，则任意一根柱子都可由 $3$ 减去其他两根柱子的编号求得。

设将第 $k$ 根柱子上的 $i$ 个圆盘移到确定的第 $g[k][i]$ 根柱子上需要 $f[k][i]$ 步，可由状态 $i-1$ 转移过来。

首先，f[0][1] 和 g[0][1] 是确定的，接下来，既然前 $i-1$ 个圆盘移动到的柱子已经确定了，那么第 $i$ 个圆盘移动到的柱子必然也是确定的。判断当前情况属于上面的方案 $1$ 还是方案 $2$，进行状态转移即可。

---

从网上看到还有打表找规律的做法……$dfs$ 处理出 $n=1,2,3$ 的情况，得到：

$$d[i]=k×d[i−1]+b$$

其中 $k=\frac{d[3]−d[2]}{d[2]−d[1]},b=d[3]−k×d[2]$

打表找规律不失为一项妙计……
