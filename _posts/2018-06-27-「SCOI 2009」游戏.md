---
title: 「SCOI 2009」游戏
date: 2018-06-27 09:15:46
categories:
- 动态规划
mathjax: true
---

> 题目大意：给定一个长度为 $n$ 的排列，初始时为 $1 \cdots n$，可以从该序列开始，通过若干次相同的置换再回到该序列，求对于所有可能的某种置换，有多少种可能的置换次数。$1 \leq n \leq 1000$

这就相当于一个错位排列嘛，当前新来一个元素为 $n$，假设它对应的元素是前面的 $i$，分两种情况讨论：

第一种，$i$ 对应的元素也是 $n$，则状态由 $f[n-2]$ 转移过来；f[n-2] 与 2 的最小公倍

第二种，$i$ 对应的元素不是 $n$，则状态由 $f[n-1]$ 转移过来，去掉 $i$ 选择自己的情况。 n

若 $n$ 对应的元素是其本身，则状态由 $f[n-1]$ 转移过来。~~

所以有状态转移方程：

$$f[n] = f[n-1] + lcm(f[n-2],2) + f[i-1] - f[i-2]$$

设 $f[i]$ 表示长度为 $i$ 的排列的方案数，有 $f[i] = \sum_{j=1}^{\lfloor \frac{i}{2} \rfloor} lcm(f[j],f[i-j])$
