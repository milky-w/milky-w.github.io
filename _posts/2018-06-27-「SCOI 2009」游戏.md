---
title: 「SCOI 2009」游戏
date: 2018-06-27 09:15:46
categories:
- 动态规划
mathjax: true
---

> 题目大意：给定一个长度为 $n$ 的排列，初始时为 $1 \cdots n$，可以从该序列开始，通过若干次相同的置换再回到该序列，求对于所有可能的某种置换，有多少种可能的置换次数。$1 \leq n \leq 1000$

一开始什么错位排列，$LCM$ 都想了一遍……

容易发现置换次数为所有循环节长度的 $LCM$，可以将问题转换成把 $n$ 分成若干个和 $\leq n$ 的数，求这些数的 $LCM$ 的种数。

进一步，当每个循环节长度都两两互质时，$LCM$ 才不会重复，也就是将每个数写成 $p_i^{a_i}$ 的形式，保证 $p_i$ 互不相同。

于是可以将 $n$ 质因数分解，类似于背包问题，$f[i][j]$ 表示前 $i$ 个质数和为 $j$ 的方案数，得 $DP$ 转移方程：

$$f[i][j] = f[i-1][j] + \sum_{k=1}^{a_i} f[i-1][j-p_i^{k}]$$
